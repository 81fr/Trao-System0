<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    
    <title>ุงูุฅุนุฏุงุฏุงุช - ุชุฑุงูู</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="assets/vendor/fontawesome/css/all-svg.css">

    <!-- PWA / Mobile App Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00A59B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

</head>

<body>

    <nav class="sidebar">
        <div class="sidebar-header">
            <img src="assets/logo.png" alt="TRAOF Logo" style="max-height:56px;">
        </div>
        <ul class="nav-links">
            <li><a href="index.html"><i class="fas fa-home"></i> ููุญุฉ ุงูุชุญูู</a></li>
            <li><a href="cards.html"><i class="fas fa-credit-card"></i> ุงูุจุทุงูุงุช</a></li>
            <li><a href="wallets.html"><i class="fas fa-wallet"></i> ุงููุญุงูุธ</a></li>
            <li><a href="merchants.html"><i class="fas fa-store"></i> ุงููุชุงุฌุฑ</a></li>
            <li><a href="orders.html"><i class="fas fa-file-invoice-dollar"></i> ุฃูุงูุฑ ุงูุชูุฑูุฏ</a></li>
            <li><a href="pos.html"><i class="fas fa-cash-register"></i> ููุทุฉ ุงูุจูุน</a></li>
            <li><a href="reports.html"><i class="fas fa-chart-bar"></i> ุงูุชูุงุฑูุฑ</a></li>
            <li><a href="users.html"><i class="fas fa-users-cog"></i> ุงููุณุชุฎุฏููู</a></li>
            <li><a href="settings.html" class="active"><i class="fas fa-cog"></i> ุงูุฅุนุฏุงุฏุงุช</a></li>
            <li><a href="support.html"><i class="fas fa-headset"></i> ุงูุฏุนู ุงูููู</a></li>
        </ul>

    </nav>

    <main class="main-content">
        <header>
            <h1><i class="fas fa-cog"></i> ุงูุฅุนุฏุงุฏุงุช</h1>
            <div class="user-profile"><span>ูุฑุญุจุงู</span>
                <div class="avatar">ู</div>
            </div>
        </header>

        <div class="form-container">
            <h3><i class="fas fa-columns"></i> ุชุฎุทูุท ุงูุตูุญุฉ</h3>
            <div class="form-group" style="display:flex; gap:20px; align-items:center;">
                <label style="cursor:pointer; display:flex; align-items:center; gap:8px;">
                    <input type="radio" name="layoutMode" value="side" checked onchange="Settings.saveLayout('side')">
                    <span>ูุงุฆูุฉ ุฌุงูุจูุฉ (ูููู)</span>
                </label>
                <label style="cursor:pointer; display:flex; align-items:center; gap:8px;">
                    <input type="radio" name="layoutMode" value="top" onchange="Settings.saveLayout('top')">
                    <span>ูุงุฆูุฉ ุนูููุฉ</span>
                </label>
            </div>
        </div>

        <div class="form-container">
            <h3>ุงูุชุณููุงุช</h3>
            <div class="form-group"><label>ุงุณู "ุงูุจุทุงูุงุช"</label><input id="label_cards" type="text"
                    placeholder="ุงูุจุทุงูุงุช"></div>
            <div class="form-group"><label>ุงุณู "ุงููุญุงูุธ"</label><input id="label_wallets" type="text"
                    placeholder="ุงููุญุงูุธ"></div>
            <div class="form-group"><label>ุงุณู "ุงููุชุงุฌุฑ"</label><input id="label_merchants" type="text"
                    placeholder="ุงููุชุงุฌุฑ"></div>
            <div class="form-group"><label>ุงุณู "ุงููุณุชููุฏูู"</label><input id="label_beneficiaries" type="text"
                    placeholder="ุงููุณุชููุฏูู"></div>
            <button onclick="Settings.saveLabels()"><i class="fas fa-save"></i> ุญูุธ ุงูุชุณููุงุช</button>
        </div>

        <div class="form-container">
            <h3><i class="fas fa-tags"></i> ุงูุชุตูููุงุช</h3>
            <div class="form-group" style="display:flex; gap:10px;">
                <input id="newCategoryInput" type="text" placeholder="ุฃุฏุฎู ุชุตูููุงู ุฌุฏูุฏุงู (ูุซุงู: ุฎุฏูุงุช ุนุงูุฉ)">
                <button class="secondary" onclick="Settings.addCategory()"><i class="fas fa-plus"></i> ุฅุถุงูุฉ</button>
            </div>
            <ul id="categoriesList" class="nav-links" style="padding:0;"></ul>
        </div>

        <div class="form-container">
            <h3><i class="fas fa-users"></i> ุงููุณุชููุฏูู</h3>

            <!-- ุงูุงุณู ุงูุฑุจุงุนู - 4 ุญููู -->
            <div
                style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:10px; margin-bottom:15px;">
                <div class="form-group" style="margin:0;">
                    <label>ุงูุงุณู ุงูุฃูู</label>
                    <input id="benFirstName" type="text" placeholder="ุงูุงุณู ุงูุฃูู">
                </div>
                <div class="form-group" style="margin:0;">
                    <label>ุงุณู ุงูุฃุจ</label>
                    <input id="benFatherName" type="text" placeholder="ุงุณู ุงูุฃุจ">
                </div>
                <div class="form-group" style="margin:0;">
                    <label>ุงุณู ุงูุฌุฏ</label>
                    <input id="benGrandName" type="text" placeholder="ุงุณู ุงูุฌุฏ">
                </div>
                <div class="form-group" style="margin:0;">
                    <label>ุงุณู ุงูุนุงุฆูุฉ</label>
                    <input id="benFamilyName" type="text" placeholder="ุงุณู ุงูุนุงุฆูุฉ">
                </div>
            </div>

            <!-- ุงูุฌูุณูุฉ -->
            <div class="form-group">
                <label>ุงูุฌูุณูุฉ</label>
                <select id="beneficiaryNationality" onchange="updateIdHint()">
                    <option value="saudi">ุณุนูุฏู</option>
                    <option value="non_saudi">ูููู (ุบูุฑ ุณุนูุฏู)</option>
                    <option value="gulf">ุฎููุฌู</option>
                </select>
            </div>

            <!-- ุฑูู ุงููููุฉ -->
            <div class="form-group">
                <label>ุฑูู ุงููููุฉ / ุงูุฅูุงูุฉ</label>
                <input id="beneficiaryID" type="text" inputmode="numeric" placeholder="ุฃุฏุฎู ุฑูู ุงููููุฉ"
                    oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                <small id="idHint" style="color:#888; display:block; margin-top:4px;">
                    ๐ธ๐ฆ ุณุนูุฏู: ูุฌุจ ุฃู ูุชููู ูู 10 ุฃุฑูุงู
                </small>
            </div>

            <!-- ุฑูู ุงูุฌูุงู -->
            <div class="form-group">
                <label>ุฑูู ุงูุฌูุงู</label>
                <input id="beneficiaryMobile" type="text" inputmode="numeric" maxlength="10" placeholder="05xxxxxxxx"
                    oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                <small style="color:#888; display:block; margin-top:4px;">ูุจุฏุฃ ุจู 05 ููุชููู ูู 10 ุฃุฑูุงู</small>
            </div>

            <!-- ุฑูู ุงูููู -->
            <div class="form-group">
                <label>ุฑูู ุงูููู</label>
                <input id="beneficiaryFileNum" type="text" placeholder="ุฑูู ุงูููู">
            </div>

            <button onclick="Settings.addBeneficiary()"><i class="fas fa-user-plus"></i> ุฅุถุงูุฉ ูุณุชููุฏ</button>

            <div class="table-container" style="margin-top:14px;">
                <table>
                    <thead>
                        <tr>
                            <th>ุงูุงุณู ุงูุฑุจุงุนู</th>
                            <th>ุงูุฌูุณูุฉ</th>
                            <th>ุฑูู ุงููููุฉ</th>
                            <th>ุฑูู ุงูุฌูุงู</th>
                            <th>ุฑูู ุงูููู</th>
                            <th>ุนุฏุฏ ุงูุจุทุงูุงุช</th>
                            <th>ุฅุฌุฑุงุก</th>
                        </tr>
                    </thead>
                    <tbody id="beneficiariesTableBody"></tbody>
                </table>
            </div>
        </div>

        <script>
            function updateIdHint() {
                const nat = document.getElementById('beneficiaryNationality').value;
                const hint = document.getElementById('idHint');
                const idInput = document.getElementById('beneficiaryID');
                const rules = {
                    'saudi': { text: '๐ธ๐ฆ ุณุนูุฏู: ูุฌุจ ุฃู ูุชููู ูู 10 ุฃุฑูุงู', max: 10 },
                    'non_saudi': { text: '๐ข ูููู: ูุฌุจ ุฃู ูุชููู ูู 10 ุฃุฑูุงู (ุฑูู ุงูุฅูุงูุฉ)', max: 10 },
                    'gulf': { text: '๐ ุฎููุฌู: ูุฌุจ ุฃู ูุชููู ูู 10 ุฃุฑูุงู', max: 10 }
                };
                const rule = rules[nat] || rules['saudi'];
                hint.textContent = rule.text;
                idInput.maxLength = rule.max;
                idInput.value = idInput.value.substring(0, rule.max);
            }
            // Initialize hint on page load
            document.addEventListener('DOMContentLoaded', updateIdHint);
        </script>

        <div class="form-container" style="border-color: #ffc107; background: #fffdf5;">
            <h3><i class="fas fa-database"></i> ุจูุงูุงุช ุชุฌุฑูุจูุฉ</h3>
            <p style="color:#666; margin-bottom:15px; font-size:0.9rem;">ููููู ุชุญููู ุจูุงูุงุช ุชุฌุฑูุจูุฉ (ูุชุงุฌุฑุ ูุณุชููุฏููุ
                ุจุทุงูุงุชุ ุฃูุงูุฑ ุชูุฑูุฏ) ูุชุฌุฑุจุฉ ุงููุธุงู. ุณูุชู ูุณุญ ุงูุจูุงูุงุช ุงูุญุงููุฉ.</p>
            <button onclick="injectDummyData()" style="background:#ffc107; color:#000;"><i class="fas fa-sync"></i>
                ุชุญููู ุจูุงูุงุช ุชุฌุฑูุจูุฉ</button>
        </div>
        <footer class="main-footer">
            <p>ุตูุน ูู ุชุฑุงุคู</p>
            <img src="assets/logo.png" alt="TRAOF Logo">
        </footer>
    </main>
    <script src="script.js?v=5"></script>
    <script src="dummy_data.js?v=5"></script>

    <script>
        // PWA Service Worker Register
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(reg => console.log('SW registered!', reg))
                    .catch(err => console.log('SW failed!', err));
            });
        }
    </script>

</body>

</html>